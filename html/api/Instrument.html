<!DOCTYPE html><html lang="en"><head ><title >Instrument Mode</title><meta charset="UTF-8"/><link rel="stylesheet" type="text/css" href="lua-doc.css"/><script rel="stylesheet" type="text/javascript" src="lua-doc.js"></script></head><body ><div class="navigation-bar"><span class="navigation"><a href="index.html">Factorio</a> &raquo; Instrument Mode</span><span class="version">Factorio 1.0.0</span></div><h1 >Instrument Mode</h1><p ></p><p >
Instrument Mode allows a mod a chance to inject extra code very early in all Lua states. One mod at a time may be enabled for Instrument Mode, using the command line argument <code >--instrument-mod modname</code>. This is intended to be used to provide mod development tools and other instrumentation, in combination with the Lua debug library and <a href="LuaProfiler.html">LuaProfiler</a>. Multiplayer is disabled while an Instrument Mode mod is enabled. The following additions to the usual <a href="Data-Lifecycle.html"> Data Lifecycle</a> apply:</p> <H2>1. The settings stage</h2> <p >If the Instrument Mode mod has a file instrument-settings.lua, it is loaded in settings stage before all mods. Settings stage then proceeds as normal.</p> <h2>2. The data stage</h2> <p >If the Instrument Mode mod has a file instrument-data.lua, it is loaded in data stage before all mods. Data stage then proceeds as normal.</p> <h2>3. control.lua initialization</h2> <p >If the Instrument Mode mod has a file instrument-control.lua, it is loaded in every mod&#x27;s control stage Lua state before control.lua. Control stage then proceeds as normal.</p> <h2>on_error</h2> <p >In all three instrument files, an extra global function <code >on_error(f)</code> may be used to register an error handler for that Lua state. The handler receives the thrown error object (a <a href="Concepts.html#LocalisedString">LocalisedString</a>) and may return a <a href="Concepts.html#LocalisedString">LocalisedString</a> to be added to the displayed error message.
</p><div class="brief-listing"></div></body></html>