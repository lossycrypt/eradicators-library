<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Erlib Documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>ldoc</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Startup_methods">Startup methods </a></li>
<li><a href="#Generic_methods">Generic methods </a></li>
<li><a href="#Savedata_management">Savedata management </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/Core.html">Core</a></li>
  <li><a href="../modules/Types.html">Types</a></li>
  <li><a href="../modules/Concepts.html">Concepts</a></li>
  <li><a href="../modules/Cache.html">Cache</a></li>
  <li><a href="../modules/Data.html">Data</a></li>
  <li><a href="../modules/Template.html">Template</a></li>
  <li><a href="../modules/Entity.html">Entity</a></li>
  <li><a href="../modules/EventManager.html">EventManager</a></li>
  <li><a href="../modules/EventManagerLite.html">EventManagerLite</a></li>
  <li><a href="../modules/Force.html">Force</a></li>
  <li><a href="../modules/Gui.html">Gui</a></li>
  <li><a href="../modules/Locale.html">Locale</a></li>
  <li><a href="../modules/Player.html">Player</a></li>
  <li><a href="../modules/PluginManager.html">PluginManager</a></li>
  <li><strong>PluginManagerLite</strong></li>
  <li><a href="../modules/Remote.html">Remote</a></li>
  <li><a href="../modules/Setting.html">Setting</a></li>
  <li><a href="../modules/Stacktrace.html">Stacktrace</a></li>
  <li><a href="../modules/Train.html">Train</a></li>
  <li><a href="../modules/Array.html">Array</a></li>
  <li><a href="../modules/Class.html">Class</a></li>
  <li><a href="../modules/Coding.html">Coding</a></li>
  <li><a href="../modules/Color.html">Color</a></li>
  <li><a href="../modules/Compare.html">Compare</a></li>
  <li><a href="../modules/Debug.html">Debug</a></li>
  <li><a href="../modules/Error.html">Error</a></li>
  <li><a href="../modules/Filter.html">Filter</a></li>
  <li><a href="../modules/Iter.html">Iter</a></li>
  <li><a href="../modules/Lambda.html">Lambda</a></li>
  <li><a href="../modules/LocalisedString.html">LocalisedString</a></li>
  <li><a href="../modules/Lock.html">Lock</a></li>
  <li><a href="../modules/Log.html">Log</a></li>
  <li><a href="../modules/Logic.html">Logic</a></li>
  <li><a href="../modules/Math.html">Math</a></li>
  <li><a href="../modules/Meta.html">Meta</a></li>
  <li><a href="../modules/Polygon.html">Polygon</a></li>
  <li><a href="../modules/Replicate.html">Replicate</a></li>
  <li><a href="../modules/Set.html">Set</a></li>
  <li><a href="../modules/String.html">String</a></li>
  <li><a href="../modules/Table.html">Table</a></li>
  <li><a href="../modules/Time.html">Time</a></li>
  <li><a href="../modules/Tool.html">Tool</a></li>
  <li><a href="../modules/Vector.html">Vector</a></li>
  <li><a href="../modules/Verificate.html">Verificate</a></li>
  <li><a href="../modules/Version.html">Version</a></li>
  <li><a href="../modules/remotes.html">remotes</a></li>
  <li><a href="../modules/snippet.html">snippet</a></li>
  <li><a href="../modules/Babelfish.html">Babelfish</a></li>
</ul>
<h2>Source</h2>
<ul class="nowrap">
  <li><a href="../source/Introduction.html">Introduction</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>PluginManagerLite</code></h1>
<p>Helper for developing mod-like plugins and softmods.</p>
<p> <a href="../source/Introduction.html#DevelopmentStatus">Module Status</a>: Work in progress.</p>
    <h3>Usage:</h3>
    <ul>
        <pre class="example">local PluginManager = require(&apos;__eradicators-library__/erlib/factorio/PluginManagerLite-1&apos;)()
</pre>
    </ul>


<h2><a href="#Startup_methods">Startup methods </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Public.make_asset_getter">Public.make_asset_getter(plugin_name[, mod_name])</a></td>
	<td class="summary">A function to convert relative asset paths into absolute file paths.</td>
	</tr>
</table>
<h2><a href="#Generic_methods">Generic methods </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Public.make_relative_require">Public.make_relative_require(plugin_name[, mod_name])</a></td>
	<td class="summary">Creates a require function that works relative to a plugins directory.</td>
	</tr>
</table>
<h2><a href="#Savedata_management">Savedata management </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Savedata">Savedata</a></td>
	<td class="summary">The save-load-cycle persistant data of a plugin.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#enable_savedata_management">enable_savedata_management()</a></td>
	<td class="summary">Starts the savedata management engine.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#manage_savedata">manage_savedata(plugin_name, setter[, default])</a></td>
	<td class="summary">Automatically loads global Savedata and assigns local references.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#classify_savedata">classify_savedata(plugin_name, methods)</a></td>
	<td class="summary">Automatically adds meta-methods to Savedata in on_load and on_config.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#manage_garbage">manage_garbage(plugin_name)</a></td>
	<td class="summary">Automatically deletes player, force and surface related
 Savedata when it becomes invalid.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Startup_methods"></a>Startup methods </h2>

    <dl class="function">
    <dt>
    <a name = "Public.make_asset_getter"></a>
    <strong>Public.make_asset_getter(plugin_name[, mod_name])</strong>
    </dt>
    <dd>
    A function to convert relative asset paths into absolute file paths.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">plugin_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">mod_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         Defaults to the name of the mod that called this function.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/pil/2.6.html">function</a></span>
        f(path)
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> f = PluginManager.make_asset_getter(<span class="string">'my-plugin-name'</span>, <span class="string">'my-mod-name'</span>)
<span class="global">print</span>(f(<span class="string">'/my-file-name.png'</span>))
&gt; <span class="string">"__my-mod-name__/assets/my-plugin-name/my-file-name.png"</span>

</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Generic_methods"></a>Generic methods </h2>

    <dl class="function">
    <dt>
    <a name = "Public.make_relative_require"></a>
    <strong>Public.make_relative_require(plugin_name[, mod_name])</strong>
    </dt>
    <dd>
    Creates a require function that works relative to a plugins directory.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">plugin_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">mod_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         Defaults to the name of the mod that called this function.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="https://www.lua.org/pil/2.6.html">function</a></span>
         f(path)
   The function will call <a href="../lua-5.2/doc/manual.html#pdf-require">require</a> like this: <br/>
   <code>require(&quot;__my-mod-name__/plugins/my-plugin-name/&quot;..path)</code>.
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> import = PluginManager.make_relative_require(<span class="string">'my-plugin-name'</span>, <span class="string">'my-mod-name'</span>)
<span class="keyword">local</span> my_module = import(<span class="string">'/my-module-name.lua'</span>)
</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Savedata_management"></a>Savedata management </h2>

    <dl class="function">
    <dt>
    <a name = "Savedata"></a>
    <strong>Savedata</strong>
    </dt>
    <dd>
    The save-load-cycle persistant data of a plugin. </p>

<p> A sub-table of the global table called <a href="../api/global.html#global">global</a>,
 that contains all data created and stored by a single plugin.







</dd>
    <dt>
    <a name = "enable_savedata_management"></a>
    <strong>enable_savedata_management()</strong>
    </dt>
    <dd>
    Starts the savedata management engine. </p>

<p> This requires unrestricted exclusive access to
 <code>global.plugin_manager</code>. Do not touch it.</p>

<p> <strong>Note:</strong> Implicitly loads <a href="../modules/EventManagerLite.html#">EventManagerLite</a>. Can not be used without. <br/>
 <strong>Note:</strong> The other savedata management methods do not exist before calling this.







</dd>
    <dt>
    <a name = "manage_savedata"></a>
    <strong>manage_savedata(plugin_name, setter[, default])</strong>
    </dt>
    <dd>
    Automatically loads global Savedata and assigns local references. </p>

<p> Multiple setters can be associated with the same plugin_name.
 This allows using local Savedata references in all files used by a plugin.</p>

<p> Can only be uesd after <a href="../modules/PluginManagerLite.html#enable_savedata_management">PluginManagerLite.enable_savedata_management</a>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">plugin_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">setter</span>
            <span class="types"><a class="type" href="https://www.lua.org/pil/2.6.html">function</a></span>
         Will be called setter(Savedata) in on_load and on_config.
 (See <a href="../modules/EventManagerLite.html#boostrap_event_order">EventManagerLite.boostrap_event_order</a> regarding on_init.)
        </li>
        <li><span class="parameter">default</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-table">table</a></span>
         The default layout for your Savedata.
 Use if you want certain subtables to always exist. In on_config any
 key that doesn't exist in the Savegame yet will be copied from this.
         (<em>optional</em>)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> Savedata; PM.manage_savedata(<span class="string">'plugin_name'</span>, <span class="keyword">function</span>(_) Savedata = _ <span class="keyword">end</span>, {
  players = {}, forces = {}, surfaces = {}, map = {}
  })
</pre>
    </ul>

</dd>
    <dt>
    <a name = "classify_savedata"></a>
    <strong>classify_savedata(plugin_name, methods)</strong>
    </dt>
    <dd>
    Automatically adds meta-methods to Savedata in on_load and on_config. </p>

<p> This only has to be called once per plugin_name as it affects all setters.</p>

<p> This also enables automatic creation-on-first-access of Savedata sub-tables
 'players','forces','surfaces' and 'map' if the methods table
 has no metatable itself.</p>

<p> Can only be uesd after <a href="../modules/PluginManagerLite.html#enable_savedata_management">PluginManagerLite.enable_savedata_management</a>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">plugin_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">methods</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-table">table</a></span>
         This table will be assigned as the __index metatable
 for the Savedata table.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "manage_garbage"></a>
    <strong>manage_garbage(plugin_name)</strong>
    </dt>
    <dd>
    Automatically deletes player, force and surface related
 Savedata when it becomes invalid. </p>

<p> Assumes Savedata contains subtables "players", "surfaces" and/or "forces",
 using the respective objects "index" as keys.</p>

<p> Because it's easy to forget to always subscribe to
 <a href="../api/events.html#on_player_removed">on_player_removed</a>,
 <a href="../api/events.html#on_forces_merged">on_forces_merged</a> and
 <a href="../api/events.html#on_surface_deleted">on_surface_deleted</a>.</p>

<p> Garbage collection is called after all other EventManagerLite event
 handlers have finished processing the respective event.
 <strong>Note:</strong> Be careful when you subscribe to one of the above events
 youself. If you create new data with the old index it will still be
 deleted at the end of the event.</p>

<p> Can only be uesd after <a href="../modules/PluginManagerLite.html#enable_savedata_management">PluginManagerLite.enable_savedata_management</a>.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">plugin_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2021-06-04 21:03:34 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
