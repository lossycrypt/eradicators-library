<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Erlib Documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>ldoc</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Tables">Tables</a></li>
<li><a href="#Todo">Todo </a></li>
<li><a href="#Concepts">Concepts</a></li>
<li><a href="#Factorio_Behavior">Factorio Behavior </a></li>
<li><a href="#Examples">Examples </a></li>
<li><a href="#Expert_Methods">Expert Methods </a></li>
<li><a href="#Custom_Event_Management">Custom Event Management</a></li>
<li><a href="#Event_groups">Event groups </a></li>
<li><a href="#Handler_Methods">Handler Methods </a></li>
<li><a href="#Built_in_Meta_Events">Built-in Meta-Events</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/Core.html">Core</a></li>
  <li><a href="../modules/Types.html">Types</a></li>
  <li><a href="../modules/Concepts.html">Concepts</a></li>
  <li><a href="../modules/Cache.html">Cache</a></li>
  <li><a href="../modules/Data.html">Data</a></li>
  <li><a href="../modules/Template.html">Template</a></li>
  <li><a href="../modules/Entity.html">Entity</a></li>
  <li><strong>EventManager</strong></li>
  <li><a href="../modules/EventManagerLite.html">EventManagerLite</a></li>
  <li><a href="../modules/Force.html">Force</a></li>
  <li><a href="../modules/Gui.html">Gui</a></li>
  <li><a href="../modules/Locale.html">Locale</a></li>
  <li><a href="../modules/Player.html">Player</a></li>
  <li><a href="../modules/PluginManagerLite.html">PluginManagerLite</a></li>
  <li><a href="../modules/Prototype.html">Prototype</a></li>
  <li><a href="../modules/Remote.html">Remote</a></li>
  <li><a href="../modules/Setting.html">Setting</a></li>
  <li><a href="../modules/Stacktrace.html">Stacktrace</a></li>
  <li><a href="../modules/Train.html">Train</a></li>
  <li><a href="../modules/Wube.html">Wube</a></li>
  <li><a href="../modules/Array.html">Array</a></li>
  <li><a href="../modules/Class.html">Class</a></li>
  <li><a href="../modules/Coding.html">Coding</a></li>
  <li><a href="../modules/Color.html">Color</a></li>
  <li><a href="../modules/Compare.html">Compare</a></li>
  <li><a href="../modules/Debug.html">Debug</a></li>
  <li><a href="../modules/Error.html">Error</a></li>
  <li><a href="../modules/Filter.html">Filter</a></li>
  <li><a href="../modules/Iter.html">Iter</a></li>
  <li><a href="../modules/Lambda.html">Lambda</a></li>
  <li><a href="../modules/LocalisedString.html">LocalisedString</a></li>
  <li><a href="../modules/Lock.html">Lock</a></li>
  <li><a href="../modules/Log.html">Log</a></li>
  <li><a href="../modules/Logic.html">Logic</a></li>
  <li><a href="../modules/Math.html">Math</a></li>
  <li><a href="../modules/Meta.html">Meta</a></li>
  <li><a href="../modules/Polygon.html">Polygon</a></li>
  <li><a href="../modules/Replicate.html">Replicate</a></li>
  <li><a href="../modules/Set.html">Set</a></li>
  <li><a href="../modules/String.html">String</a></li>
  <li><a href="../modules/Table.html">Table</a></li>
  <li><a href="../modules/Time.html">Time</a></li>
  <li><a href="../modules/Tool.html">Tool</a></li>
  <li><a href="../modules/Vector.html">Vector</a></li>
  <li><a href="../modules/Verificate.html">Verificate</a></li>
  <li><a href="../modules/Version.html">Version</a></li>
  <li><a href="../modules/remotes.html">remotes</a></li>
  <li><a href="../modules/snippet.html">snippet</a></li>
  <li><a href="../modules/Babelfish.html">Babelfish</a></li>
</ul>
<h2>Source</h2>
<ul class="nowrap">
  <li><a href="../source/Introduction.html">Introduction</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>EventManager</code></h1>
<p><strong>Deprecated.</strong> Multiple handlers per event and easy future actions.</p>
<p> <strong>Note:</strong> EventManager is incompatible with mods that directly access
 <a href="../api/LuaBootstrap.html#LuaBootstrap.">LuaBootstrap</a>. To ensure smooth operations it replaces <code>script</code>
 with a wrapper that behaves like the real script as close as possible,
 but not all functionality is available (yet). Keeping local references
 to <code>script</code> is not supported and will break EventManager.</p>

<p> <strong>Note:</strong> EventManager stores it's private data in <strong>global.event_manager</strong>.
 Messing with that data will break EventManager.</p>

<p> Quirks, Tips and Tricks:</p>

<ul>
    <li><p>OnTick handlers can not be executed in a guaranteed order, as the order
    depends on each handlers period, last execution and en/disable history.</p></li>
    <li><p>Only actions take extra queue arguments, but normal handlers can be
    <a href="../modules/EventManager.html#call">called</a> with extra arguments.</p></li>
    <li><p>OnTicks can not be registered to other events.</p></li>
    <li><p>Actions use en/dequeue. OnTicks use en/disable.</p></li>
</ul>

<p> <a href="../source/Introduction.html#DevelopmentStatus">Module Status</a>: Deprecated, use <a href="../modules/EventManagerLite.html#">EventManagerLite</a>.</p>
    <h3>Usage:</h3>
    <ul>
        <pre class="example">local EventManager = require(&apos;__eradicators-library__/erlib/factorio/EventManager/EventManager-10&apos;)()
</pre>
    </ul>


<h2><a href="#Tables">Tables</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#on_research_reset">on_research_reset</a></td>
	<td class="summary">Raised when the researched state of a technology has changed from true to
 false.</td>
	</tr>
</table>
<h2><a href="#Todo">Todo </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#todo1">todo1</a></td>
	<td class="summary">BUG: new<em>private</em>event_uid is not unique to the PIG</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#todo5">todo5</a></td>
	<td class="summary">New Event
 DebugOncePerLoad Event
 -> needs EventManager.new<em>event</em>name?</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#todo3">todo3</a></td>
	<td class="summary">New Event
 Retro-gen event</p>

<p> starts a series of re-generation chunk events (tick distributed?) to which the mod can then react</p>

<p> last chunk event must carry {e.final=true}</p>

<p> must be different event than normal chunk_generated.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#todo10">todo10</a></td>
	<td class="summary">Disable on_tick when not needed.</td>
	</tr>
</table>
<h2><a href="#Concepts">Concepts</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#EventUID">EventUID</a></td>
	<td class="summary">The unique identifier of an event.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Action">Action</a></td>
	<td class="summary">A handler subscribed to 'action' instead of to an event.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#OnTick">OnTick</a></td>
	<td class="summary">A handler subscribed to defines.events.on_tick.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#NonTick">NonTick</a></td>
	<td class="summary">A handler subscribed to any event except on_tick.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Simulation">Simulation</a></td>
	<td class="summary">Enforces raising of easily missable events.</td>
	</tr>
</table>
<h2><a href="#Factorio_Behavior">Factorio Behavior </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#api_availability">api_availability</a></td>
	<td class="summary">What apis are available during on_init, on_load and on_config?</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#boostrap_event_order">boostrap_event_order</a></td>
	<td class="summary">In what order do on_init, on_load and on_config happen?</td>
	</tr>
</table>
<h2><a href="#Examples">Examples </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Examples">Examples</a></td>
	<td class="summary">

</td>
	</tr>
</table>
<h2><a href="#Expert_Methods">Expert Methods </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#disable_desync_protection">disable_desync_protection()</a></td>
	<td class="summary"><strong>Warranty void if removed</strong>.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#suppress_logging">suppress_logging(event_uid)</a></td>
	<td class="summary">Selectively disable logging for specific events.</td>
	</tr>
</table>
<h2><a href="#Custom_Event_Management">Custom Event Management</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#event_uid">event_uid</a></td>
	<td class="summary">A table like <a href="../api/defines.html#defines">defines.events</a> for custom and modded events.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#new_event">new_event(event_name[, event_uid])</a></td>
	<td class="summary">Tells EventManager about mod-created event names.</td>
	</tr>
</table>
<h2><a href="#Event_groups">Event groups </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#event_uid_group">event_uid_group</a></td>
	<td class="summary">Event groups to easily subscribe to multiple events.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#event_uid_group.on_entity_created">event_uid_group.on_entity_created</a></td>
	<td class="summary">Build-related events.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#event_uid_group.on_entity_removed">event_uid_group.on_entity_removed</a></td>
	<td class="summary">Destroy-related events.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#event_uid_group.er:control.move-any">event_uid_group.er:control.move-any</a></td>
	<td class="summary">Move-related events.</td>
	</tr>
</table>
<h2><a href="#Handler_Methods">Handler Methods </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#new_handler">new_handler(args)</a></td>
	<td class="summary">Add another event handler.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#enable">enable(handler_name)</a></td>
	<td class="summary">Enables a handler.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#disable">disable(handler_name)</a></td>
	<td class="summary">Disables a handler.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#enqueue">enqueue(ticks, action_name, ...)</a></td>
	<td class="summary">Schedule an action to be called in the future.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#dequeue">dequeue(action_name[, from_tick=1[, to_tick=infinity]])</a></td>
	<td class="summary">Remove previously made future schedules for an action.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#call">call(handler_name[, ...])</a></td>
	<td class="summary">Calls a registered handler directly.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#raise_private">raise_private(event_uid, event_data)</a></td>
	<td class="summary">Raises an event only for the current mod.</td>
	</tr>
</table>
<h2><a href="#Built_in_Meta_Events">Built-in Meta-Events</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#on_entity_created">on_entity_created</a></td>
	<td class="summary">All-in-one entity building event.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#on_player_changed_chunk">on_player_changed_chunk</a></td>
	<td class="summary">Raised when the player moves or is teleported across a chunk border on
 the same surfaces or has moved to another surface.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Tables"></a>Tables</h2>

    <dl class="function">
    <dt>
    <a name = "on_research_reset"></a>
    <strong>on_research_reset</strong>
    </dt>
    <dd>
    Raised when the researched state of a technology has changed from true to
 false.  For example because another mod called <a href="../api/LuaForce.html#LuaForce.reset">LuaForce.reset</a>.


    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">research</span>
            <span class="types"><a class="type" href="../api/LuaTechnology.html">LuaTechnology</a></span>



        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Todo"></a>Todo </h2>

    <dl class="function">
    <dt>
    <a name = "todo1"></a>
    <strong>todo1</strong>
    </dt>
    <dd>
    BUG: new<em>private</em>event_uid is not unique to the PIG







</dd>
    <dt>
    <a name = "todo5"></a>
    <strong>todo5</strong>
    </dt>
    <dd>
    New Event
 DebugOncePerLoad Event
 -> needs EventManager.new<em>event</em>name?   .private<em>event</em>name?
 -> needs EventManager.are<em>there</em>any<em>handlers</em>for<em>this</em>event(event<em>name)
   to prevent pointlessly registering on</em>tick when nobody uses it







</dd>
    <dt>
    <a name = "todo3"></a>
    <strong>todo3</strong>
    </dt>
    <dd>
    New Event
 Retro-gen event</p>

<p> starts a series of re-generation chunk events (tick distributed?) to which the mod can then react</p>

<p> last chunk event must carry {e.final=true}</p>

<p> must be different event than normal chunk_generated.  -> does it? on<em>retrogen</em>chunk</p>

<p> include LuaRendering debug marker? (i.e. a square on the chunk)</p>

<p> (does gui update during tick_paused? can force update one tick -> show progress bar?)</p>

<p> Better to do a series of actions for one specific handler?







</dd>
    <dt>
    <a name = "todo10"></a>
    <strong>todo10</strong>
    </dt>
    <dd>
    Disable on_tick when not needed. </p>

<p> Periodically (every 5/10/15 minutes?) check if the queue contains anything
 and disable it if not. -> Requires on_load checks, en/disable en/dequeue checks.</p>

<p> "Periodically" means on_load must emulate exact behavior. -> Easier
 to track if queue has at least one tick (every time it does something).</p>

<p> EventManager.activate<em>queue</em>if<em>not</em>active() deactivate<em>queue</em>if_active()







</dd>
</dl>
    <h2 class="section-header "><a name="Concepts"></a>Concepts</h2>

    <dl class="function">
    <dt>
    <a name = "EventUID"></a>
    <strong>EventUID</strong>
    </dt>
    <dd>
    The unique identifier of an event. </p>

<p> An EventUID is any <a href="../modules/Types.html#NaturalNumber">NaturalNumber</a> or <a href="../lua-5.2/doc/manual.html#pdf-string">string</a> that could be used to register
 an event handler with <a href="../api/LuaBootstrap.html#LuaBootstrap.on_event">script.on_event()</a>.</p>

<p> That means any NaturalNumber from <a href="../api/defines.html#defines">defines.events</a>,
 any NaturalNumber number generated with
 <a href="../api/LuaBootstrap.html#LuaBootstrap.generate_event_name">script.generate_event_name</a>(),
 any name of a <a href="../api/LuaCustomInputPrototype.html#LuaCustomInputPrototype.">LuaCustomInputPrototype</a>,
 or one of the literal strings
 <code>&quot;action&quot;</code>, <code>&quot;on_init&quot;</code>, <code>&quot;on_load</code>" and <code>&quot;on_config</code>".







</dd>
    <dt>
    <a name = "Action"></a>
    <strong>Action</strong>
    </dt>
    <dd>
    A handler subscribed to 'action' instead of to an event. </p>

<p> Actions are event handlers that are registered for the EventUID <code>&quot;action&quot;</code>.
 Actions <strong>do not happen naturally</strong>. Instead they are used with
 <a href="../modules/EventManager.html#enqueue">EventManager.enqueue</a> and <a href="../modules/EventManager.html#dequeue">EventManager.dequeue</a> to manually
 schedule <strong>future</strong> script actions that do not depend on events.







</dd>
    <dt>
    <a name = "OnTick"></a>
    <strong>OnTick</strong>
    </dt>
    <dd>
    A handler subscribed to defines.events.on_tick. </p>

<p> OnTick handlers handle <strong>only</strong> <a href="../api/events.html#on_tick">on_tick</a>. They can not
 be subscribed to any other type of event, and <strong>can not be used as actions</strong>.







</dd>
    <dt>
    <a name = "NonTick"></a>
    <strong>NonTick</strong>
    </dt>
    <dd>
    A handler subscribed to any event except on_tick. </p>

<p> Can be subscribed to any event type or custom input.
 Can simultaenously handle multiple event types and <strong>can be used as</strong>
 <a href="../modules/EventManager.html#Action">Actions</a>.







</dd>
    <dt>
    <a name = "Simulation"></a>
    <strong>Simulation</strong>
    </dt>
    <dd>
    Enforces raising of easily missable events. </p>

<p> Because of certain quirks of the factorio engine a mod might not
 recieve an event even if it has a handler for that event.</p>

<p> Specifically a mod will not recieve <strong>any</strong> events before it's own
 on_init handler has finished. Thus any events raised by <strong>other mods</strong>
 during their on_init will be missed. I call this <strong>overshadowing</strong>.</p>

<p> Simulation aims to reduce edge cases and make event handlers more reliable.
 For this EventManager simulates <strong>some</strong> of these
 overshadowed events when it detects them in it's own on_init. </p>

<p> Namely EventManager detects the creation and deletition of surfaces,
 forces and players. And the researching and <strong>un</strong>researching of technologies.</p>

<p> All simulated events are raised with the additional event data
 <code>{simulated = true}</code> to make them distingusishable from natural events.</p>

<p> Simulation also happens when the mod is first added to a map. This means
 even <strong>if your mod is added to an old map</strong> you will still recieve i.e.
 on_player_created for <strong>all</strong> players that already exist in the map.
 Removing the need to manually detect which players, forces or surfaces
 already existed before.</p>

<p> <strong>Known Issue:</strong> Simulated on_forces_merged events only contains <code>source_index</code>,
 but not <code>source_name</code> or <code>destination</code> because that information is lost for
 overshadowed force mergers.







</dd>
</dl>
    <h2 class="section-header has-description"><a name="Factorio_Behavior"></a>Factorio Behavior </h2>

          <div class="section-description">
           See also <a href="../api/Data-Lifecycle.html#">-Lifecycle</a>.
          </div>
    <dl class="function">
    <dt>
    <a name = "api_availability"></a>
    <strong>api_availability</strong>
    </dt>
    <dd>
    What apis are available during on_init, on_load and on_config?






    <h3>Usage:</h3>
    <ul>
        <pre class="example">on_init   : remote commands settings rcon rendering script game
on_load   : remote commands settings rcon           script
on_config : remote commands settings rcon rendering script game
</pre>
    </ul>

</dd>
    <dt>
    <a name = "boostrap_event_order"></a>
    <strong>boostrap_event_order</strong>
    </dt>
    <dd>

<p>In what order do on_init, on_load and on_config happen? </p>

<p>  Base game order:</p>
<pre><code>InstallMod -&gt; StartMap                         : on_init   -       -        -         -   　
InstallMod -&gt; StartMap -&gt; SaveMap    -&gt; LoadMap:   -       -     on_load    -         -   　
InstallMod -&gt; StartMap -&gt; ChangeMod  -&gt; LoadMap:   -       -     on_load  on_config   -   　
StartMap   -&gt; SaveMap  -&gt; InstallMod -&gt; LoadMap: on_init   -       -      on_config   -   　
</code></pre>

<p>  EventManager additionally raises on_load after each on_init and on_config event.
  This way on_load is guaranteed to be executed under all circumstances and can
  be used as a reliable post-processor.</p>

<p>  Absurdly the engine raises on_load* <em>before</em> on_config, running it
  on potentially outdated global data. There's nothing I can do about that
  so you have to take countermeasures yourself. EventManager will however
  skip that on_load* event if it's own global data needs to be updated first.</p>

<p>  EventManager order:</p>
<pre><code>InstallMod -&gt; StartMap                         : on_init+ON_LOAD   -        -         -
InstallMod -&gt; StartMap -&gt; SaveMap    -&gt; LoadMap:   -       -     on_load    -         -
InstallMod -&gt; StartMap -&gt; UpdateMod  -&gt; LoadMap:   -       -     on_load* on_config+ON_LOAD
StartMap   -&gt; SaveMap  -&gt; InstallMod -&gt; LoadMap: on_init+ON_LOAD   -      on_config+ON_LOAD
</code></pre>










</dd>
</dl>
    <h2 class="section-header "><a name="Examples"></a>Examples </h2>

    <dl class="function">
    <dt>
    <a name = "Examples"></a>
    <strong>Examples</strong>
    </dt>
    <dd>









    <h3>Usage:</h3>
    <ul>
        <li><pre class="example"><span class="comment">-- same basic syntax as script.on_event
</span>EventManager.new_handler {
  defines.events.on_entity_damaged,
  <span class="keyword">function</span>(e)
    game.<span class="global">print</span>{<span class="string">''</span>, <span class="string">'Entity '</span>, e.entity.name, <span class="string">' was damaged.'</span>}
    <span class="keyword">end</span>
  }
</pre></li>
        <li><pre class="example"><span class="comment">-- Low level events use string names.
</span><span class="comment">-- Multiple events can be registered simultaenously.
</span>EventManager.new_handler {
  {EventManager.event_uid.on_init,    <span class="comment">-- script.on_init
</span>   EventManager.event_uid.on_config}, <span class="comment">-- script.on_configuration_changed
</span>  <span class="keyword">function</span>()
    global.my_mod_data = global.my_mod_data <span class="keyword">or</span> {}
    <span class="keyword">end</span>
  }
</pre></li>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Expert_Methods"></a>Expert Methods </h2>

    <dl class="function">
    <dt>
    <a name = "disable_desync_protection"></a>
    <strong>disable_desync_protection()</strong>
    </dt>
    <dd>
    <strong>Warranty void if removed</strong>.
 Turns all desync prevention measures off.







</dd>
    <dt>
    <a name = "suppress_logging"></a>
    <strong>suppress_logging(event_uid)</strong>
    </dt>
    <dd>
    Selectively disable logging for specific events.
 Useful when <code>on_tick</code>, <code>on_chunk_generated</code> or similar events log-spam too much.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">event_uid</span>
            <span class="types"><a class="type" href="../modules/EventManager.html#EventUID">EventUID</a></span>



        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Custom_Event_Management"></a>Custom Event Management</h2>

    <dl class="function">
    <dt>
    <a name = "event_uid"></a>
    <strong>event_uid</strong>
    </dt>
    <dd>
    A table like <a href="../api/defines.html#defines">defines.events</a> for custom and modded events. </p>

<p> This accesses a <a href="../modules/Remote.html#PackedInterfaceGroup">PackedInterfaceGroup</a> named
 <code>&quot;erlib:managed-events&quot;</code>. It contains <a href="../modules/Types.html#KeyValuePair">(key → value)</a> pairs
 for all event names that <strong>any</strong> mod has regiestered with <a href="../modules/EventManager.html#new_event">EventManager.new_event</a>.
 This is the <strong>recommended</strong> way of accessing shared EventUIDs of other mods.</p>

<p> <strong>Note:</strong> If your mod doesn't use EventManager you can use
 <a href="../modules/remotes.html#events">remotes.events</a> instead.






    <h3>Usage:</h3>
    <ul>
        <pre class="example">EventManager.new_handler{
  EventManager.event_uid.on_other_mods_custom_event,
  <span class="keyword">function</span>(e)
    <span class="global">print</span>(<span class="string">"I'm using a shared event!"</span>)
    <span class="keyword">end</span>
  }
</pre>
    </ul>

</dd>
    <dt>
    <a name = "new_event"></a>
    <strong>new_event(event_name[, event_uid])</strong>
    </dt>
    <dd>
    Tells EventManager about mod-created event names.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">event_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">event_uid</span>
            <span class="types"><a class="type" href="../modules/Types.html#NaturalNumber">NaturalNumber</a></span>
         If you have an id from somewhere else
 you can pass it along. Otherwise EventManager will check if it <strong>already has</strong>
 a uid for the given event name (i.e. from another mod)
 and if not <strong>generate</strong> a <strong>new</strong> one.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/EventManager.html#EventUID">EventUID</a></span>
         The new uid is automatically included in
 <a href="../modules/EventManager.html#event_uid">EventManager.event_uid</a>.
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Event_groups"></a>Event groups </h2>

    <dl class="function">
    <dt>
    <a name = "event_uid_group"></a>
    <strong>event_uid_group</strong>
    </dt>
    <dd>
    Event groups to easily subscribe to multiple events. <br/>
 <strong>Eperimental/Legacy.</strong> Will be completely changed in the near future.







</dd>
    <dt>
    <a name = "event_uid_group.on_entity_created"></a>
    <strong>event_uid_group.on_entity_created</strong>
    </dt>
    <dd>
    Build-related events. <br/>
 * on_built_entity <br/>
 * on_robot_built_entity <br/>
 * script_raised_built <br/>
 * script_raised_revive







</dd>
    <dt>
    <a name = "event_uid_group.on_entity_removed"></a>
    <strong>event_uid_group.on_entity_removed</strong>
    </dt>
    <dd>
    Destroy-related events. <br/>
 * on_entity_died <br/>
 * on_player_mined_entity <br/>
 * on_robot_mined_entity <br/>
 * script_raised_destroy







</dd>
    <dt>
    <a name = "event_uid_group.er:control.move-any"></a>
    <strong>event_uid_group.er:control.move-any</strong>
    </dt>
    <dd>

<p>Move-related events.   </p>

<ul>
    <li>control.move-up/right/down/left  </li>
</ul>










</dd>
</dl>
    <h2 class="section-header "><a name="Handler_Methods"></a>Handler Methods </h2>

    <dl class="function">
    <dt>
    <a name = "new_handler"></a>
    <strong>new_handler(args)</strong>
    </dt>
    <dd>
    Add another event handler.  Does not affect already registered handlers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">args</span>


        <ul>
        <li><span class="parameter">1</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a> or <a class="type" href="../modules/Types.html#DenseArray">DenseArray</a></span>
         One or multiple event uids. This
 can be a defines.events number, a custom-input name string,
 one of the literal strings 'action','on_init','on_load','on_config'.
 or a (nested) DenseArray.
        </li>
        <li><span class="parameter">2</span>
            <span class="types"><a class="type" href="https://www.lua.org/pil/2.6.html">function</a></span>
         The handler function.
 Actions and NonTicks will be called f(event,player), containing player only
 for events with player_index. OnTicks will be called f(tick_number).
        </li>
        <li><span class="parameter">name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         The <strong>unique</strong> name of the handler. Needed to
 en/disable and en/dequeue the handler during runtime. <strong>Mandatory for
 OnTick handlers and actions</strong>.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">name_prefix</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         A string prefixed to the name of the
 handler for <strong>logging</strong> purposes <strong>only</strong>. Does not have to be unique.
 Useful to distinguish between groups of handlers.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">enabled</span>
            <span class="types"><a class="type" href="../api/Builtin-Types.html#boolean">boolean</a></span>
         If the handler is enabled by default.
 <strong>Ignored</strong> when the handler is executed as action.
         (<em>default</em> true)
        </li>
        <li><span class="parameter">persistent</span>
            <span class="types"><a class="type" href="../api/Builtin-Types.html#boolean">boolean</a></span>
         Persistent handlers can not be
 en/disabled. They are always active. This is useful only for certain
 EventManager internal events.
         (<em>default</em> true)
        </li>
        <li><span class="parameter">filter</span>
            <span class="types"><a class="type" href="https://www.lua.org/pil/2.6.html">function</a></span>
         A function that will be called
 fi(event,player) before the hanler function. If it does not return
 truthy then the main handler will not be called. Any <strong>changes</strong> made to
 the event table <strong>will be passed on</strong> to the main handler.
 <strong>Ignored</strong> when the handler is executed as action or OnTick.
 <strong>Filters must never invalidtate factorio objects.</strong> Otherwise the next
 event might be raised with invalid userdata.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">probability</span>
            <span class="types"><a class="type" href="../modules/Types.html#UnitInterval">UnitInterval</a></span>
         Randomly skip the handler completely.
 <strong>Ignored</strong> when the handler is executed as action or OnTick.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">period</span>
            <span class="types"><a class="type" href="../modules/Types.html#NaturalNumber">NaturalNumber</a></span>
         Mandatory for <a href="../modules/EventManager.html#OnTick">OnTick</a>, optional for
 <a href="../modules/EventManager.html#Action">Action</a>, ignored by everything else.
 The delay between two executions of the handler. Zero means that
 the handler is only run once and does not automatically repeat.
 If you enqueue an Action with a period > 0 you have to manually dequeue it
 later or it will repeat forever.
         (<em>default</em> 0)
        </li>
        </li></ul>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         args.name, Returned for easy access to dynamically
 generated Action names.
    </ol>




</dd>
    <dt>
    <a name = "enable"></a>
    <strong>enable(handler_name)</strong>
    </dt>
    <dd>
    Enables a handler.
 Works for OnTick and all other events. Has no meaning for actions.</p>

<p> Enabling an on_tick handler will not run it immediately. It will be
 be run according to it's own period as if it had never been disabled.</p>

<p> <strong>Note:</strong> Can only be called from inside event handlers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">handler_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
    </ul>





</dd>
    <dt>
    <a name = "disable"></a>
    <strong>disable(handler_name)</strong>
    </dt>
    <dd>
    Disables a handler.
 Works for OnTick and all other events.
 Has no meaning for actions.</p>

<p> Disabled handlers do not recieve any events.</p>

<p> <strong>Note:</strong> Can only be called from inside event handlers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">handler_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
    </ul>





</dd>
    <dt>
    <a name = "enqueue"></a>
    <strong>enqueue(ticks, action_name, ...)</strong>
    </dt>
    <dd>
    Schedule an action to be called in the future. </p>

<p> <strong>Note:</strong> Can only be called from inside event handlers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ticks</span>
            <span class="types"><a class="type" href="../modules/Types.html#NaturalNumber">NaturalNumber</a> or <a class="type" href="../modules/Types.html#DenseArray">DenseArray</a></span>
         How many ticks in the future this
 should be executed.
        </li>
        <li><span class="parameter">action_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>
         The name used to register the handler you want
 to call.
        </li>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="../modules/Types.html#AnyValue">AnyValue</a></span>
         Additional arguments that will be passed to the handler.
 A <strong>copy</strong> of these will be given to the handler on execution. It is the
 <strong>same</strong> copy for all ticks given. Thus actions that occur on multiple
 ticks or have a period can safely store intermediate data in args tables,
 however this data can not be accessed from outside the action handler.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../modules/Types.html#DenseArray">DenseArray</a></span>
         All ticks that the handler has been queued for. Useful
 if you later want to dequeue it from specific ticks.
    </ol>




</dd>
    <dt>
    <a name = "dequeue"></a>
    <strong>dequeue(action_name[, from_tick=1[, to_tick=infinity]])</strong>
    </dt>
    <dd>
    Remove previously made future schedules for an action. </p>

<p> <strong>Note:</strong> Can only be called from inside event handlers.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">action_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">from_tick</span>
            <span class="types"><a class="type" href="../modules/Types.html#NaturalNumber">NaturalNumber</a></span>
         Do not remove the actions from ticks earlier than this.
         (<em>default</em> 1)
        </li>
        <li><span class="parameter">to_tick</span>
            <span class="types"><a class="type" href="../modules/Types.html#NaturalNumber">NaturalNumber</a></span>
         Do not remove the actions from ticks later than this.
         (<em>default</em> infinity)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "call"></a>
    <strong>call(handler_name[, ...])</strong>
    </dt>
    <dd>
    Calls a registered handler directly.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">handler_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">...</span>
            <span class="types"><a class="type" href="../modules/Types.html#AnyValue">AnyValue</a></span>
         Additional arguments for the handler.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        The data returned by the handler.
    </ol>




</dd>
    <dt>
    <a name = "raise_private"></a>
    <strong>raise_private(event_uid, event_data)</strong>
    </dt>
    <dd>
    Raises an event only for the current mod.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">event_uid</span>
            <span class="types"><a class="type" href="../modules/EventManager.html#EventUID">EventUID</a></span>



        </li>
        <li><span class="parameter">event_data</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-table">table</a></span>
         Extra data to be passed to all event handlers.
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Built_in_Meta_Events"></a>Built-in Meta-Events</h2>

    <dl class="function">
    <dt>
    <a name = "on_entity_created"></a>
    <strong>on_entity_created</strong>
    </dt>
    <dd>
    All-in-one entity building event. </p>

<p> Combines the following events: <br/>
 <a href="../api/Events.html#on_built_entity">on_built_entity</a> <br/>
 <a href="../api/Events.html#on_robot_built_entity">on_robot_built_entity</a> <br/>
 <a href="../api/Events.html#script_raised_built">script_raised_built</a> <br/>
 <a href="../api/Events.html#script_raised_revive">script_raised_revive</a> <br/>
 <a href="../api/Events.html#on_entity_cloned">on_entity_cloned</a> <br/>
 <a href="../api/Events.html#on_trigger_created_entity">on_trigger_created_entity</a>


    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">created_entity</span>
            <span class="types"><a class="type" href="../api/LuaEntity.html">LuaEntity</a></span>
         The entity built.
        </li>
        <li><span class="parameter">created_entity_name</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">created_entity_type</span>
            <span class="types"><a class="type" href="../lua-5.2/doc/manual.html#pdf-string">string</a></span>



        </li>
        <li><span class="parameter">robot</span>
            <span class="types"><a class="type" href="../api/LuaEntity.html">LuaEntity</a></span>
         The robot that did the building.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">player</span>
            <span class="types"><a class="type" href="../api/LuaPlayer.html">LuaPlayer</a></span>
         The player who did the building.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">player_index</span>
            <span class="types"><a class="type" href="../api/Builtin-Types.html#uint">uint</a></span>



         (<em>optional</em>)
        </li>
        <li><span class="parameter">stack</span>
            <span class="types"><a class="type" href="../api/LuaItemStack.html">LuaItemStack</a></span>
         The item used to do the building.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">item</span>
            <span class="types"><a class="type" href="../api/LuaItemPrototype.html">LuaItemPrototype</a></span>
         The item prototype used to build the entity. Note this won't exist in some situations (built from blueprint, undo, etc).
         (<em>optional</em>)
        </li>
        <li><span class="parameter">tags</span>
            <span class="types"><a class="type" href="../api/Concepts.html#Tags">Tags</a></span>
         The tags associated with this entity.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">clone_source</span>
            <span class="types"><a class="type" href="../api/LuaEntity.html">LuaEntity</a></span>
         The entity that this entity was cloned from.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">trigger_source</span>
            <span class="types"><a class="type" href="../api/LuaEntity.html">LuaEntity</a></span>
         The entity with a trigger prototype (such as capsules) that created this entity.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "on_player_changed_chunk"></a>
    <strong>on_player_changed_chunk</strong>
    </dt>
    <dd>
    Raised when the player moves or is teleported across a chunk border on
 the same surfaces or has moved to another surface. </p>

<p> Abstracts: <br/>
 <a href="../api/Events.html#on_player_changed_position">on_player_changed_position</a> <br/>
 <a href="../api/Events.html#on_player_changed_surface">on_player_changed_surface</a>


    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">player_index</span>
            <span class="types"><a class="type" href="../api/Builtin-Types.html#uint">uint</a></span>



        </li>
        <li><span class="parameter">surface_index</span>
            <span class="types"><a class="type" href="../api/Builtin-Types.html#uint">uint</a> or <a class="type" href="https://www.lua.org/pil/2.1.html">nil</a></span>
         <em>If</em> the player changed surfaces then this is
 the old surfaces index.
        </li>
        <li><span class="parameter">old_chunk</span>
            <span class="types"><a class="type" href="../api/Concepts.html#ChunkPositionAndArea">ChunkPositionAndArea</a></span>



        </li>
        <li><span class="parameter">new_chunk</span>
            <span class="types"><a class="type" href="../api/Concepts.html#ChunkPositionAndArea">ChunkPositionAndArea</a></span>



        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2021-08-14 04:31:05 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
